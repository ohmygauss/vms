require 'rails_helper'

describe 'Vulnerability Feature', type: :feature do
  before(:each) do
    create(:product, name: 'Test 1')
  end

  describe 'Adding vulnerabilities' do
    it 'allows products to be added via a form' do
      visit '/'
      click_on 'Details'
      click_on 'Add vulnerability'
      fill_in 'Issue', with: 'an issue'
      fill_in 'Severity', with: 'high'
      fill_in 'Remediation', with: 'a fix'
      click_on 'Create Vulnerability'

      expect(page).to have_content 'Issue: an issue'
      expect(page).to have_content 'Severity: high'
    end
  end
end